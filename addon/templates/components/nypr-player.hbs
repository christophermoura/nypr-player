{{#liquid-if displayNotificationBar class='notification-wrapper'}}
  {{#nypr-player.notification dismissNotification = (action 'dismissNotification')}}
    {{yield (hash notification=true)}}
  {{/nypr-player.notification}}
{{/liquid-if}}

{{nypr-player.backdrop backdropImageUrl=backdropImageUrl}}

{{#holygrail-layout as |g|}}
  {{#g.left}}
    <div class="nypr-player--controls">
      <button class="btn btn--blank btn--playerdark persistent-skipbutton" {{action 'rewind'}} aria-text="rewind 15 seconds" aria-labelledby="rewind-label">
        {{!--
        Moving aria labels inside of buttons. See example 4 here.
        https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute

        Ran into bug in firefox with flexbox justify-content. It was considering absolutely positioned elements as flex items, even though they are out-of-flow. It's current behaviour here is based on an old version of the spec. See https://bugzilla.mozilla.org/show_bug.cgi?id=874718
        --}}
        <label class="visuallyhidden" id="rewind-label">Rewind 15 seconds</label>
        {{nypr-svg className = "icon" icon = "rewind15"}}
      </button>

      {{nypr-player.listen-button
        state        = playState
        currentTitle = currentTitle
        click        = (action 'playOrPause')}}

      <button class="btn btn--blank btn--playerdark persistent-skipbutton" {{action 'fastForward'}}  aria-text="skip forward 15 seconds" aria-labelledby="fastforward-label">
        <label class="visuallyhidden" id="fastforward-label">Skip ahead 15 seconds</label>
        {{nypr-svg className="icon" icon="forward15"}}
      </button>
    </div>
  {{/g.left}}

  {{#g.center}}
    <div class="nypr-playerinfo">
      <div class="nypr-playerinfoline">
        {{#text-crawl watch=currentAudio}}
          {{nypr-player.audio-metadata
            showTitle      = showTitle
            showUrl        = showUrl
            showUrlTarget  = showUrlTarget
            storyTitle     = storyTitle
            storyUrl       = storyUrl
            storyUrlTarget = storyUrlTarget
            audioId        = audioId
            songDetails    = songDetails
          }}
        {{/text-crawl}}

        {{#if hifi.duration}} {{! only show the share button when the audio has loaded}}
          {{#if hasBlock}}
            {{! For consumers to drop in a share button}}
            {{yield (hash share=true)}}
          {{/if}}
        {{/if}}
      </div>

      {{#if isAudiostream}}
        {{nypr-player.stream-metadata
          streamScheduleUrl       = streamScheduleUrl
          streamScheduleUrlTarget = streamScheduleUrlTarget
          streamPlaylistUrl       = streamPlaylistUrl
          streamPlaylistUrlTarget = streamPlaylistUrlTarget
          streamUrl               = streamUrl
          streamUrlTarget         = streamUrlTarget
          streamName              = streamName
          streamsIndexUrl         = streamsIndexUrl
          streamsIndexUrlTarget   = streamsIndexUrlTarget
        }}
      {{else}}

        {{#if media.isNyprPlayerSmallOnly}}
          {{nypr-player.time-label
            position = hifi.position
            duration = hifi.duration}}
        {{/if}}

        <div class="nypr-player-progress-area">
          {{nypr-player.progress-meter
            downloaded  = hifi.percentLoaded
            position    = hifi.position
            duration    = hifi.duration
            setPosition = (action 'setPosition')}}

          {{#if media.isNyprPlayerMediumAndUp}}
            {{nypr-player.time-label
              position = hifi.position
              duration = hifi.duration}}
          {{/if}}
        </div>
        <!-- .persistent-progress -->
      {{/if}}
    </div>
  {{/g.center}}

  {{#g.right}}
    <div class="nypr-player--controls">
      {{#if (can-change-volume)}}
        {{nypr-player.volume-control
          volume     = hifi.volume
          setVolume  = (action 'setVolume')
          toggleMute = (action 'toggleMute')
          isMuted    = hifi.isMuted}}
      {{/if}}

      {{#if hasBlock}}
        {{yield (hash queue=true) (hash queueButton=(component 'nypr-player.queue-button'))}}
      {{/if}}
    </div>
  {{/g.right}}
{{/holygrail-layout}}
