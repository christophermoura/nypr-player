{{#liquid-if displayNotificationBar class='notification-wrapper'}}
  {{#nypr-player.notification dismissNotification = (action 'dismissNotification')}}
    {{yield (hash notification=true)}}
  {{/nypr-player.notification}}
{{/liquid-if}}

{{nypr-player.backdrop backdropImageUrl=backdropImageUrl}}

{{#holygrail-layout as |g|}}
  {{#g.left}}
    <div class="nypr-player-controls">
      {{nypr-player.rewind-button click=(action 'rewind')}}

      {{nypr-player.listen-button
        state        = playState
        currentTitle = currentTitle
        click        = (action 'playOrPause')}}

      {{nypr-player.fast-forward-button click=(action 'fastForward')}}
    </div>
  {{/g.left}}

  {{#g.center}}
    <div class="nypr-player-info">
      <div class="nypr-player-infoline">
        {{nypr-player.audio-metadata
          showTitle      = showTitle
          showUrl        = showUrl
          showUrlTarget  = showUrlTarget
          storyTitle     = storyTitle
          storyUrl       = storyUrl
          storyUrlTarget = storyUrlTarget
          audioId        = audioId
          songDetails    = songDetails
        }}

        {{#if hifi.duration}} {{! only show the share button when the audio has loaded}}
          {{#if hasBlock}}
            {{! For consumers to drop in a share button}}
            {{yield (hash share=true)}}
          {{/if}}
        {{/if}}
      </div>

      {{#if isAudiostream}}
        {{nypr-player.stream-metadata
          streamScheduleUrl       = streamScheduleUrl
          streamScheduleUrlTarget = streamScheduleUrlTarget
          streamPlaylistUrl       = streamPlaylistUrl
          streamPlaylistUrlTarget = streamPlaylistUrlTarget
          streamUrl               = streamUrl
          streamUrlTarget         = streamUrlTarget
          streamName              = streamName
          streamsIndexUrl         = streamsIndexUrl
          streamsIndexUrlTarget   = streamsIndexUrlTarget
        }}
      {{else}}
        {{#if media.isNyprPlayerSmallOnly}}
          {{nypr-player.time-label
            position = hifi.position
            duration = hifi.duration}}
        {{/if}}

        <div class="nypr-player-progress-container">
          {{nypr-player.progress-meter
            downloaded  = hifi.percentLoaded
            position    = hifi.position
            duration    = hifi.duration
            setPosition = (action 'setPosition')}}

          {{#if media.isNyprPlayerMediumAndUp}}
            {{nypr-player.time-label
              position = hifi.position
              duration = hifi.duration}}
          {{/if}}
        </div>
        <!-- .persistent-progress -->
      {{/if}}
    </div>
  {{/g.center}}

  {{#g.right}}
    <div class="nypr-player-controls">
      {{#if (can-change-volume)}}
        {{nypr-player.volume-control
          volume     = hifi.volume
          setVolume  = (action 'setVolume')
          toggleMute = (action 'toggleMute')
          isMuted    = hifi.isMuted}}
      {{/if}}

      {{#if hasBlock}}
        {{yield (hash queue=true) (hash queueButton=(component 'nypr-player.queue-button'))}}
      {{/if}}
    </div>
  {{/g.right}}
{{/holygrail-layout}}
